name: base-experiments

resources:
  cloud: runpod
  # accelerators: H100-SXM:1
  accelerators: RTX4090:1
  cpus: 8+
  memory: 32+
  disk_size: 200
  image_id: 'runpod/pytorch:2.4.0-py3.11-cuda12.4.1-devel-ubuntu22.04'

num_nodes: 1

# Files to sync
workdir: .

setup: |
  set -e

  # Configure git identity (REPLACE WITH YOUR INFO)
  git config --global user.name $GIT_USER
  git config --global user.email $GIT_EMAIL
  
  # Configure git safe directory for the workspace
  git config --global --add safe.directory '*'
  

  # Install uv if not present
  if ! command -v uv &> /dev/null; then
    curl -LsSf https://astral.sh/uv/install.sh | sh
    source $HOME/.cargo/env
  fi

  # Sync Python dependencies
  uv sync && source .venv/bin/activate
  
  echo "Setup completed successfully"

# Run command
run: |
  set -e
  source .venv/bin/activate
  
  # Ready for your training script
  echo "Environment ready"